(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return n(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?n(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==a.return||a.return()}finally{if(s)throw i}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,r(a.key),a)}}function o(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var o=a.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}var i=function(){function e(n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"element",null),o(this,"pageMap",{}),o(this,"currentPageName",null),o(this,"currentPageTitle",null),this.element=n;var r,i=t(n.querySelectorAll("div.page-panel-page"));try{for(i.s();!(r=i.n()).done;){var c=r.value,s=c.getAttribute("page");this.pageMap[s]=c,c.classList.contains("page-panel-visible")&&(this.currentPageName=s)}}catch(e){i.e(e)}finally{i.f()}var l,u=t(n.querySelectorAll("div.page-panel-nav a"));try{for(u.s();!(l=u.n()).done;){var d=l.value,m=d.getAttribute("page");this.pageMap[m]&&(this.pageMap[m].link=d,d.addEventListener("click",(function(e){e.preventDefault(),a.switchPage(e.target.getAttribute("page"))})))}}catch(e){u.e(e)}finally{u.f()}var h=new Event("panelCreated");h.panel=this,this.element.dispatchEvent(h)}var n,r,i;return n=e,i=[{key:"init",value:function(){var n,a=t(document.querySelectorAll("div.page-panel"));try{for(a.s();!(n=a.n()).done;){var o=n.value;e.pagePanels[o.id]=new e(o)}}catch(e){a.e(e)}finally{a.f()}}}],(r=[{key:"switchPage",value:function(e){var t=this.currentPageName;if(t!==e&&this.pageMap[e]){this.pageMap[t].classList.remove("page-panel-visible"),this.pageMap[t].link.parentElement.classList.remove("page-panel-active"),this.pageMap[e].classList.add("page-panel-visible"),this.pageMap[e].link.parentElement.classList.add("page-panel-active"),this.currentPageName=e,this.currentPageTitle=this.pageMap[e].link.innerText;var n=new Event("panelSwitched");n.panel=this,this.element.dispatchEvent(n)}}},{key:"hasPage",value:function(e){return Object.hasOwn?Object.hasOwn(this.pageMap,e):Object.prototype.hasOwnProperty.call(this.pageMap,e)}}])&&a(n.prototype,r),i&&a(n,i),Object.defineProperty(n,"prototype",{writable:!1}),e}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,u(a.key),a)}}function l(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!==c(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===c(t)?t:String(t)}o(i,"pagePanels",{});var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"show",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Ok";return this.confirm(e,t,n,null)}},{key:"confirm",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Ok",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Cancel";return new Promise((function(r,i){var c=document.getElementById("overlay"),s=document.getElementById("dialog"),l=document.getElementById("dialog_message"),u=document.getElementById("dialog_explanation"),d=document.getElementById("dialog_action_button"),m=document.getElementById("dialog_cancel_button");c&&s&&l&&u&&d&&m?(c.className="exist",s.className="exist",setTimeout((function(){c.className="exist visible",s.className="exist visible"}),10),l.innerText=e,u.innerText=n||"",d.clickHandler&&d.removeEventListener("click",d.clickHandler),m.clickHandler&&m.removeEventListener("click",m.clickHandler),d.clickHandler=function(){t.hide(),setTimeout((function(){r()}),300)},d.addEventListener("click",d.clickHandler),d.innerText=a,o?(m.clickHandler=function(){t.hide(),setTimeout((function(){i()}),300)},m.addEventListener("click",m.clickHandler),m.innerText=o):m.className="hidden"):i()}))}},{key:"hide",value:function(){var e=document.getElementById("overlay"),t=document.getElementById("dialog");e&&t&&(e.className="exist",t.className="exist",setTimeout((function(){e.className="",t.className=""}),300))}},{key:"showModal",value:function(e){var t=this;if(!this.activeModal){var n=document.getElementById("overlay"),a=document.getElementById(e);n&&a&&(n.classList.add("exist"),a.classList.add("exist"),this.activeModal=e,setTimeout((function(){n.classList.add("visible"),a.classList.add("visible")}),10),this.viewportWatcher=setInterval((function(){if(t.activeModal){document.querySelectorAll("#".concat(t.activeModal," .modal-content .content")).forEach((function(e){a.classList.toggle("scrolled",e.scrollHeight>e.clientHeight)}));var e=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);a.classList.toggle("centered",a.clientHeight>.75*e)}}),100))}}},{key:"hideModal",value:function(){var e=this;return new Promise((function(t,n){if(e.activeModal){var a=document.getElementById("overlay"),o=document.getElementById(e.activeModal);a&&o?(e.viewportWatcher&&(clearInterval(e.viewportWatcher),e.viewportWatcher=null),a.classList.remove("visible"),o.classList.remove("visible"),setTimeout((function(){a.classList.remove("exist"),o.classList.remove("exist"),e.activeModal=null,t()}),300)):n()}else n()}))}}],null&&s(t.prototype,null),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function h(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!==m(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key),"symbol"===m(o)?o:String(o)),a)}var o}l(d,"activeModal",null),l(d,"viewportWatcher",null);var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"prepareResponse",value:function(e){return{xhr:e,status:e.status,statusText:e.statusText,body:e.responseText,success:e.status>=200&&e.status<300||304===e.status}}},{key:"start",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise((function(r,i){var c=new XMLHttpRequest;if(c.open(e,t,!0),"object"===m(o)&&null!==o&&!1===Array.isArray(o))for(var s=0,l=Object.keys(o);s<l.length;s++){var u=l[s];c.setRequestHeader(u,o[u])}c.onload=function(){var e=n.prepareResponse(c);e.success?r(e):i(e)},c.onerror=function(){i(n.prepareResponse(c))},c.send(a)}))}},{key:"get",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.start("GET",t,null,n)}},{key:"post",value:function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n instanceof URLSearchParams?(a["Content-Type"]="application/x-www-form-urlencoded",e.start("POST",t,n.toString(),a)):"object"===m(n)&&null!==n||Array.isArray(n)?(a["Content-Type"]="application/json",e.start("POST",t,JSON.stringify(n),a)):e.start("POST",t,n,a)}},{key:"delete",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.start("DELETE",t,null,n)}}],null&&h(t.prototype,null),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw r}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}document.addEventListener("beaconRunAccountPanel",(function(e){var t=e.accountProperties,n="",a=t.sessionId,o=t.apiDomain,r=document.getElementById("account-user-header"),c=r.getAttribute("beacon-user-name"),s=r.getAttribute("beacon-user-suffix"),l="".concat(c,"#").concat(s),u=function(){var e=window.location.hash;return e?(e.startsWith("#")&&(e=e.substr(1)),e):""};i.init();var m=i.pagePanels["panel-account"];m&&(m.switchPage(u()),window.addEventListener("popstate",(function(){m.switchPage(u())})));var h=document.getElementById("panel-account");h&&h.addEventListener("panelSwitched",(function(e){window.location.hash=e.panel.currentPageName}));var p,y=f(document.querySelectorAll('#panel-account div[page="projects"] [beacon-action="delete"]'));try{for(y.s();!(p=y.n()).done;)p.value.addEventListener("click",(function(e){e.preventDefault();var t=e.target.getAttribute("beacon-resource-url"),n=e.target.getAttribute("beacon-resource-name");return d.confirm('Are you sure you want to delete the project "'+n+'?"',"The project will be deleted immediately and cannot be recovered.","Delete").then((function(){v.delete(t,{Authorization:"Bearer ".concat(a)}).then((function(){d.show("Project deleted",'"'+n+'" has been deleted.').then((function(){window.location.reload(!0)}))})).catch((function(e){401===e.status?d.show("Project not deleted","There was an authentication error"):d.show("Project not deleted","Sorry, there was a ".concat(e.status," error."))}))})).catch((function(){})),!1}))}catch(e){y.e(e)}finally{y.f()}var g=document.getElementById("username_action_button"),b=document.getElementById("username_field"),w=document.getElementById("suggested-username-link"),k=document.getElementById("new-suggestion-link");g&&b&&(b.addEventListener("input",(function(e){g.disabled=""===e.target.value.trim()})),g.addEventListener("click",(function(e){e.preventDefault();var t=b.value.trim();if(""===t)return d.show("Username can not be empty","How did you press the button anyway?"),!1;var n=new URLSearchParams;n.append("username",t),v.post("/account/actions/username",n).then((function(e){var t={message:"Username changed",explanation:"Your username has been changed."};try{var n=JSON.parse(e.body);t.explanation='Your username has been changed to "'.concat(n.username,'."')}catch(e){}d.show(t.message,t.explanation).then((function(){window.location.reload(!0)}))})).catch((function(e){switch(e.status){case 401:case 403:d.show("Username not changed","There was an authentication error.");break;default:d.show("Username not changed","Sorry, there was a ".concat(e.status," error."))}}))})),w&&(w.addEventListener("click",(function(e){return e.preventDefault(),b.value=e.currentTarget.getAttribute("beacon-username"),g.disabled=""===b.value.trim(),!1})),k&&k.addEventListener("click",(function(e){return v.get("/account/login/suggest").then((function(e){try{var t=JSON.parse(e.body);w&&(w.innerText=t.username,w.setAttribute("beacon-username",t.username))}catch(e){}})).catch((function(){})),e.preventDefault(),!1}))));var E=document.getElementById("email_field"),S=document.getElementById("email_action_button"),T=document.getElementById("email_need_2fa"),L=document.getElementById("email_2fa_action_button"),I=document.getElementById("email_2fa_cancel_button"),A=document.getElementById("email_2fa_code_field");if(E&&S&&T){E.addEventListener("input",(function(e){S.disabled=""===e.target.value.trim()}));var B=function(){var e=new URLSearchParams;e.append("email",E.value.trim()),e.append("verify",A?A.value.trim():""),v.post("/account/actions/email",e).then((function(){d.show("Email Change Started","The new address has been emailed a link. Please click the link to complete the change.").then((function(){window.location.reload(!0)}))})).catch((function(e){try{var t=JSON.parse(e.body);if(!t.message)throw new Error;var n=t.message;d.show("Email Change Error",n)}catch(t){switch(e.status){case 401:case 403:d.show("Email Change Error","There was an authentication error.");break;default:d.show("Email Change Error","Sorry, there was a ".concat(e.status," error."))}}}))};S.addEventListener("click",(function(e){e.preventDefault(),"true"===T.value?(A.value="",d.showModal("change_email_2fa_form"),A.focus()):B()})),L&&L.addEventListener("click",(function(e){e.preventDefault(),d.hideModal().then((function(){B()}))})),I&&I.addEventListener("click",(function(e){e.preventDefault(),d.hideModal()})),A&&A.addEventListener("input",(function(e){L.disabled=""===e.target.value.trim()}))}var P=document.getElementById("password_action_button"),x=document.getElementById("password_regenerate_check"),_=document.getElementById("change_password_form"),O=document.getElementById("password_current_field"),M=document.getElementById("password_initial_field"),j=document.getElementById("password_confirm_field"),N=document.getElementById("add-authenticator-button"),D=document.getElementById("add-authenticator-code-field"),U=document.getElementById("add-authenticator-nickname-field"),C=document.getElementById("add-authenticator-action-button"),R=document.getElementById("add-authenticator-cancel-button"),H=document.getElementById("add-authenticator-qrcode"),q=document.getElementById("authenticators_time_zone_name"),J=document.getElementById("replace-backup-codes-button");P&&x&&_&&P.addEventListener("click",(function(e){e.preventDefault();var t=O?O.value:"",a=M?M.value:"",o=j?j.value:"",r=a===n,i=x.checked,c=i;if(a.length<8)return d.show("Password too short","Your password must be at least 8 characters long."),!1;if(a!==o)return d.show("Passwords do not match","Please make sure the two passwords match."),!1;var s=new URLSearchParams;return s.append("current_password",t),s.append("password",a),s.append("allow_vulnerable",r),c&&s.append("terminate_sessions",!0),i&&s.append("regenerate_key",!0),v.post("/account/actions/password",s).then((function(){_.reset();try{var e={};e.message=i?"Your password and private key have been changed.":"Your password has been changed.",e.explanation="All sessions have been revoked and your devices will need to sign in again.",d.show(e.message,e.explanation)}catch(e){console.log(e),d.show("There was an error. Your password may or may not have been changed.")}})).catch((function(e){var t="Unable to change password",o="There was a ".concat(e.status," error while trying to change your password.");try{var r=JSON.parse(e.body);r.message&&(o=r.message)}catch(e){}switch(e.status){case 403:t="Incorrect Two Step Verification Code",o="Please get a new code from your authenticator app.";break;case 438:n=a,t="Your password is vulnerable.",o="Your password has been leaked in a previous breach and should not be used. To ignore this warning, you may submit the password again, but that is not recommended."}d.show(t,o)})),!1}));var Y=function(){if(P)return O&&M&&j?void(P.disabled=""===O.value.trim()||""===M.value.trim()||M.value!==j.value):(console.log("Missing page fields"),void(P.disabled=!0))};if(O&&O.addEventListener("input",Y),M&&M.addEventListener("input",Y),j&&j.addEventListener("input",Y),N&&D&&U&&C&&R)try{var z={authenticatorId:crypto.randomUUID?crypto.randomUUID():([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})),type:"TOTP",nickname:"Google Authenticator",metadata:{secret:null,setup:null}};D.addEventListener("input",(function(e){C.disabled=""===e.target.value.trim()})),N.addEventListener("click",(function(){z.metadata.secret=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",t=new Uint32Array(4);self.crypto.getRandomValues(t);var n,a="",o=f(t);try{for(o.s();!(n=o.n()).done;){var r=n.value;a+=e[r>>>27&31]+e[r>>>22&31]+e[r>>>17&31]+e[r>>>12&31]+e[r>>>7&31]+e[r>>>2&31]}}catch(e){o.e(e)}finally{o.f()}return a}(),z.metadata.setup="otpauth://totp/".concat(encodeURIComponent("Beacon:"+l+" ("+z.authenticatorId+")"),"?secret=").concat(z.metadata.secret,"&issuer=Beacon"),H&&(H.src="/account/assets/qr.php?content=".concat(btoa(z.metadata.setup)),H.setAttribute("alt",z.metadata.setup),H.setAttribute("title",z.metadata.setup)),D.value="",d.showModal("add-authenticator-modal")})),R.addEventListener("click",(function(){d.hideModal()})),C.addEventListener("click",(function(){z.nickname=U.value.trim(),z.verificationCode=D.value.trim(),v.post("https://".concat(o,"/v4/authenticators"),z,{Authorization:"Bearer ".concat(a)}).then((function(){window.location.reload(!0)})).catch((function(e){var t=function(){try{return JSON.parse(e.body).message}catch(e){return"Incorrect verification code"}}();D.classList.add("invalid");var n=document.querySelector('label[for="'.concat(D.id,'"]'));n&&(n.classList.add("invalid"),n.innerText=t),setTimeout((function(){n&&(n.classList.remove("invalid"),n.innerText="Verification Code"),D&&D.classList.remove("invalid")}),3e3)}))}))}catch(e){N.addEventListener("click",(function(){d.show("Sorry, this browser is not supported","There was an error generating the authenticator, which means your browser does not support modern cryptography features. Try again with an updated browser.")}))}var W=document.querySelectorAll("#authenticators-table tbody tr").length;if(W>0){(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];document.querySelectorAll("time").forEach((function(n){var a=new Date(n.getAttribute("datetime"));n.innerText=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Intl.DateTimeFormat().resolvedOptions(),o={dateStyle:"medium"};t&&(o.timeStyle="short");var r=Intl.DateTimeFormat(a.locale,o).format(e);return n&&(r="".concat(r," ").concat(a.timeZone)),r}(a,e,t)}))})(!0,!1),q&&(q.innerText=Intl.DateTimeFormat().resolvedOptions().timeZone);var V,F=f(document.querySelectorAll("button.delete_authenticator_button"));try{for(F.s();!(V=F.n()).done;)V.value.addEventListener("click",(function(e){var t=e.target.getAttribute("beacon-authenticator-id"),n=e.target.getAttribute("beacon-authenticator-name"),r={message:"Are you sure you want to delete the authenticator ".concat(n,"?")};if(W>1){var i=W-1,c=1===i?"authenticator":"authenticators";r.explanation="You will have ".concat(i," ").concat(c," remaining. Your account will still be protected by two factor authentication.")}else r.explanation="This is your only authenticator. Deleting it will disable two factor authentication for your account. You will be able to add a new authenticator to enable two factor authentication again.";d.confirm(r.message,r.explanation).then((function(){v.delete("https://".concat(o,"/v4/authenticators/").concat(t),{Authorization:"Bearer ".concat(a)}).then((function(){var e=document.getElementById("authenticator-".concat(t));e&&W>1?(e.remove(),W--):window.location.reload(!0)})).catch((function(e){var t={message:"The authenticator was not deleted",explanation:"There was a ".concat(e.status," error.")};try{var n=JSON.parse(e.body);n.message&&(t.explanation=n.message)}catch(e){}d.show(t.message,t.explanation)}))})).catch((function(){}))}))}catch(e){F.e(e)}finally{F.f()}}J&&J.addEventListener("click",(function(){d.confirm("Replace backup codes?","This will replace all of your backup codes with new ones.").then((function(){v.post("/account/actions/replace_backup_codes",{},{Authorization:"Bearer ".concat(a)}).then((function(e){try{var t=document.getElementById("backup-codes"),n=JSON.parse(e.body).codes;t.innerHTML="";var a,o=f(n);try{for(o.s();!(a=o.n()).done;){var r=a.value,i=document.createElement("div");i.innerText=r,i.className="flex-grid-item",t.appendChild(i)}}catch(e){o.e(e)}finally{o.f()}}catch(e){window.location.reload(!0)}})).catch((function(e){console.log(JSON.stringify(e));var t={message:"Backup codes not replaced",explanation:"There was a ".concat(e.status," error.")};try{var n=JSON.parse(e.body);n.message&&(t.explanation=n.message)}catch(e){}d.show(t.message,t.explanation)}))})).catch((function(){}))}));var G,Z=function(e){return e.preventDefault(),v.delete("https://".concat(o,"/v4/sessions/").concat(encodeURIComponent(e.target.getAttribute("sessionHash"))),{Authorization:"Bearer ".concat(a)}).then((function(){d.show("Session revoked","Be aware that any enabled user with a copy of your account's private key can start a new session.").then((function(){window.location.reload(!0)}))})).catch((function(e){401===e.status?d.show("Session not revoked","There was an authentication error"):d.show("Session not revoked","Sorry, there was a "+e.status+" error.")})),!1},X=f(document.querySelectorAll('#panel-account div[page="sessions"] a.revokeLink'));try{for(X.s();!(G=X.n()).done;)G.value.addEventListener("click",Z)}catch(e){X.e(e)}finally{X.f()}var $,K=function(e){e.preventDefault();var t=e.currentTarget.getAttribute("beacon-app-id");v.get("https://".concat(o,"/v4/applications/").concat(encodeURIComponent(t)),{Authorization:"Bearer ".concat(a)}).then((function(e){JSON.parse(e.body)})).catch((function(){d.show("Could not retrieve application info")}))},Q=f(document.querySelectorAll('#panel-account div[page="apps"] button.apps-edit-button'));try{for(Q.s();!($=Q.n()).done;)$.value.addEventListener("click",K)}catch(e){Q.e(e)}finally{Q.f()}var ee,te=document.getElementById("static-token-modal"),ne=document.getElementById("static-token-name-field"),ae=document.getElementById("static-token-token-field"),oe=document.getElementById("static-token-cancel-button"),re=document.getElementById("static-token-action-button"),ie=document.getElementById("static-token-provider-field"),ce=document.getElementById("static-token-generate-link"),se=document.getElementById("static-token-help-field"),le=document.getElementById("static-token-error-field"),ue=function(e){e.preventDefault();var t=e.currentTarget.getAttribute("beacon-provider"),n=e.currentTarget.getAttribute("beacon-provider-type"),r=e.currentTarget.getAttribute("beacon-token-id"),i=e.currentTarget.getAttribute("beacon-token-name");if(""===r)switch(n){case"oauth":window.location="/account/oauth/v4/begin/".concat(t);break;case"static":if(te&&ne&&ae&&ie&&ce&&se){switch(ne.value="",ae.value="",ie.value=t,le.classList.add("hidden"),t){case"nitrado":ce.href="https://server.nitrado.net/usa/developer/tokens",se.innerText='Beacon requires long life tokens from Nitrado to have the "service" scope enabled.',se.classList.remove("hidden");break;case"gameserverapp.com":ce.href="https://dash.gameserverapp.com/configure/api",se.innerText='On your GameServerApp.com dashboard, you will find an "API / Integrate" option where you can issue a token for Beacon. Copy the token into the field below to continue. Remember to keep your token in a safe place in case you need it again.',se.classList.remove("hidden")}d.showModal("static-token-modal")}}else d.confirm("Are you sure you want to remove the service ".concat(i,"?"),"You will be able to connect the service again if you choose to.","Delete","Cancel").then((function(){v.delete("https://".concat(o,"/v4/tokens/").concat(r),{Authorization:"Bearer ".concat(a)}).then((function(){window.location.reload(!0)})).catch((function(){d.show("The service was not deleted.")}))}))},de=f(document.querySelectorAll('#panel-account div[page="services"] .service-action button'));try{for(de.s();!(ee=de.n()).done;)ee.value.addEventListener("click",ue)}catch(e){de.e(e)}finally{de.f()}if(te&&ne&&ae&&oe&&re&&ie&&le){var me=function(){re.disabled=""===ne.value.trim()||""===ae.value.trim()};ne.addEventListener("input",(function(){me()})),ae.addEventListener("input",(function(){me()})),oe.addEventListener("click",(function(e){e.preventDefault(),d.hideModal()})),re.addEventListener("click",(function(e){e.preventDefault(),re.disabled=!0,le.classList.add("hidden");var t={provider:ie.value,type:"Static",accessToken:ae.value.trim(),providerSpecific:{tokenName:ne.value.trim()}},n=function(){v.post("https://".concat(o,"/v4/user/tokens"),t,{Authorization:"Bearer ".concat(a)}).then((function(){window.location.reload(!0)})).catch((function(){le.innerText="Could not save token.",le.classList.remove("hidden"),re.disabled=!1}))};"nitrado"===t.provider?v.get("https://api.nitrado.net/token",{Authorization:"Bearer ".concat(t.accessToken)}).then((function(e){var a=JSON.parse(e.body);if(!1===a.data.token.scopes.includes("service"))return le.innerText='The long life token is valid, but is missing the "service" scope that Beacon requires.',le.classList.remove("hidden"),void(re.disabled=!1);t.providerSpecific.user=a.data.token.user,n()})).catch((function(){le.innerText="The long life token is not valid. Double check the Nitrado website, as the beginning of the token can wrap to another line.",le.classList.remove("hidden"),re.disabled=!1})):n()}))}var he=new URLSearchParams(window.location.search);if(he.get("message")&&he.get("explanation")){d.show(he.get("message"),he.get("explanation"));var ve=new(window.URL||window.webkitURL||window.mozURL||window.msURL||window.oURL)(window.location);ve.search="",window.history.replaceState(null,document.title,ve.toString())}}))})();