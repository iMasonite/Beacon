(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,i(a.key),a)}}function n(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var a=i.call(t,"string");if("object"!==e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,i;return n=e,i=[{key:"show",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Ok";return this.confirm(e,t,n,null)}},{key:"confirm",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Ok",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Cancel";return new Promise((function(r,o){var c=document.getElementById("overlay"),l=document.getElementById("dialog"),s=document.getElementById("dialog_message"),u=document.getElementById("dialog_explanation"),d=document.getElementById("dialog_action_button"),h=document.getElementById("dialog_cancel_button");c&&l&&s&&u&&d&&h?(c.className="exist",l.className="exist",setTimeout((function(){c.className="exist visible",l.className="exist visible"}),10),s.innerText=e,u.innerText=n||"",d.clickHandler&&d.removeEventListener("click",d.clickHandler),h.clickHandler&&h.removeEventListener("click",h.clickHandler),d.clickHandler=function(){t.hide(),setTimeout((function(){r()}),300)},d.addEventListener("click",d.clickHandler),d.innerText=i,a?(h.clickHandler=function(){t.hide(),setTimeout((function(){o()}),300)},h.addEventListener("click",h.clickHandler),h.innerText=a):h.className="hidden"):o()}))}},{key:"hide",value:function(){var e=document.getElementById("overlay"),t=document.getElementById("dialog");e&&t&&(e.className="exist",t.className="exist",setTimeout((function(){e.className="",t.className=""}),300))}},{key:"showModal",value:function(e){var t=this;if(!this.activeModal){var n=document.getElementById("overlay"),i=document.getElementById(e);n&&i&&(n.classList.add("exist"),i.classList.add("exist"),this.activeModal=e,setTimeout((function(){n.classList.add("visible"),i.classList.add("visible")}),10),this.viewportWatcher=setInterval((function(){if(t.activeModal){document.querySelectorAll("#".concat(t.activeModal," .modal-content .content")).forEach((function(e){i.classList.toggle("scrolled",e.scrollHeight>e.clientHeight)}));var e=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);i.classList.toggle("centered",i.clientHeight>.75*e)}}),100))}}},{key:"hideModal",value:function(){var e=this;return new Promise((function(t,n){if(e.activeModal){var i=document.getElementById("overlay"),a=document.getElementById(e.activeModal);i&&a?(e.viewportWatcher&&(clearInterval(e.viewportWatcher),e.viewportWatcher=null),i.classList.remove("visible"),a.classList.remove("visible"),setTimeout((function(){i.classList.remove("exist"),a.classList.remove("exist"),e.activeModal=null,t()}),300)):n()}else n()}))}}],null&&t(n.prototype,null),i&&t(n,i),Object.defineProperty(n,"prototype",{writable:!1}),e}();function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key),"symbol"===r(a)?a:String(a)),i)}var a}n(a,"activeModal",null),n(a,"viewportWatcher",null);var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"prepareResponse",value:function(e){return{xhr:e,status:e.status,statusText:e.statusText,body:e.responseText,success:e.status>=200&&e.status<300||304===e.status}}},{key:"start",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise((function(o,c){var l=new XMLHttpRequest;if(l.open(e,t,!0),"object"===r(a)&&null!==a&&!1===Array.isArray(a))for(var s=0,u=Object.keys(a);s<u.length;s++){var d=u[s];l.setRequestHeader(d,a[d])}l.onload=function(){var e=n.prepareResponse(l);e.success?o(e):c(e)},l.onerror=function(){c(n.prepareResponse(l))},l.send(i)}))}},{key:"get",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.start("GET",t,null,n)}},{key:"post",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n instanceof URLSearchParams?(i["Content-Type"]="application/x-www-form-urlencoded",e.start("POST",t,n.toString(),i)):"object"===r(n)&&null!==n||Array.isArray(n)?(i["Content-Type"]="application/json",e.start("POST",t,JSON.stringify(n),i)):e.start("POST",t,n,i)}},{key:"delete",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.start("DELETE",t,null,n)}}],null&&o(t.prototype,null),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw r}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,m(i.key),i)}}function h(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!==l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===l(t)?t:String(t)}var f=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"element",null),h(this,"pageMap",{}),h(this,"currentPageName",null),h(this,"currentPageTitle",null),this.element=t;var i,a=s(t.querySelectorAll("div.page-panel-page"));try{for(a.s();!(i=a.n()).done;){var r=i.value,o=r.getAttribute("page");this.pageMap[o]=r,r.classList.contains("page-panel-visible")&&(this.currentPageName=o)}}catch(e){a.e(e)}finally{a.f()}var c,l=s(t.querySelectorAll("div.page-panel-nav a"));try{for(l.s();!(c=l.n()).done;){var u=c.value,d=u.getAttribute("page");this.pageMap[d]&&(this.pageMap[d].link=u,u.addEventListener("click",(function(e){e.preventDefault(),n.switchPage(e.target.getAttribute("page"))})))}}catch(e){l.e(e)}finally{l.f()}var m=new Event("panelCreated");m.panel=this,this.element.dispatchEvent(m)}var t,n,i;return t=e,i=[{key:"init",value:function(){var t,n=s(document.querySelectorAll("div.page-panel"));try{for(n.s();!(t=n.n()).done;){var i=t.value;e.pagePanels[i.id]=new e(i)}}catch(e){n.e(e)}finally{n.f()}}}],(n=[{key:"switchPage",value:function(e){var t=this.currentPageName;if(t!==e&&this.pageMap[e]){this.pageMap[t].classList.remove("page-panel-visible"),this.pageMap[t].link.parentElement.classList.remove("page-panel-active"),this.pageMap[e].classList.add("page-panel-visible"),this.pageMap[e].link.parentElement.classList.add("page-panel-active"),this.currentPageName=e,this.currentPageTitle=this.pageMap[e].link.innerText;var n=new Event("panelSwitched");n.panel=this,this.element.dispatchEvent(n)}}},{key:"hasPage",value:function(e){return Object.hasOwn?Object.hasOwn(this.pageMap,e):Object.prototype.hasOwnProperty.call(this.pageMap,e)}}])&&d(t.prototype,n),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();h(f,"pagePanels",{});var k=function(e){return Intl.NumberFormat("en-US",{style:"currency",currency:e}).format},v=function(e){return new Date(1e3*e)},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Intl.DateTimeFormat().resolvedOptions(),a={dateStyle:"medium"};t&&(a.timeStyle="short");var r=Intl.DateTimeFormat(i.locale,a).format(e);return n&&(r="".concat(r," ").concat(i.timeZone)),r};function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return(t=P(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=S(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw r}}}}function S(e,t){if(e){if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,P(i.key),i)}}function I(e,t,n){return t&&C(e.prototype,t),n&&C(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function P(e){var t=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!==y(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===y(t)?t:String(t)}function L(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function G(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,T(e,t,"get"))}function M(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,T(e,t,"set"),n),n}function T(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var x="owns",O="buying",F="in-cart",D="none";document.addEventListener("beaconRunCheckout",(function(e){var t=e.checkoutProperties,n=t.products,i=t.productIds,r=k(t.currencyCode);f.init();var o=f.pagePanels["panel-games"];o&&o.element.addEventListener("panelSwitched",(function(){o.currentPageTitle?document.title="Beacon Omni for ".concat(o.currentPageTitle):document.title="Beacon Omni",history.pushState({},"","/omni#".concat(o.currentPageName))}));var l=new WeakMap,s=new WeakMap,u=new WeakMap,d=function(){function e(t){B(this,e),L(this,l,{writable:!0,value:null}),L(this,s,{writable:!0,value:{}}),L(this,u,{writable:!0,value:!1}),t?(M(this,l,t.id),M(this,s,t.products),M(this,u,t.isGift)):M(this,l,crypto.randomUUID?crypto.randomUUID():([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})))}return I(e,[{key:"id",get:function(){return G(this,l)}},{key:"isGift",get:function(){return G(this,u)},set:function(e){M(this,u,e)}},{key:"productIds",get:function(){return Object.keys(G(this,s))}},{key:"count",get:function(){return Object.keys(G(this,s)).length}},{key:"reset",value:function(){M(this,s,{})}},{key:"add",value:function(e,t){this.setQuantity(e,this.getQuantity(e)+t)}},{key:"remove",value:function(e,t){this.setQuantity(e,this.getQuantity(e)-t)}},{key:"getQuantity",value:function(e){var t;return null!==(t=G(this,s)[e])&&void 0!==t?t:0}},{key:"setQuantity",value:function(e,t){t<=0?Object.prototype.hasOwnProperty.call(G(this,s),e)&&delete G(this,s)[e]:G(this,s)[e]=t}},{key:"toJSON",value:function(){return{id:G(this,l),products:G(this,s),isGift:G(this,u)}}},{key:"fingerprint",get:function(){var e=this,t=Object.keys(G(this,s)).sort().reduce((function(t,n){return t[n]=G(e,s)[n],t}),{});return btoa(JSON.stringify({id:G(this,l),products:t,isGift:G(this,u)}))}},{key:"hasArk",get:function(){var e;return this.getQuantity(null==n||null===(e=n.Ark)||void 0===e||null===(e=e.Base)||void 0===e?void 0:e.ProductId)>0}},{key:"hasArkSA",get:function(){var e,t,i;return this.getQuantity(null==n||null===(e=n.ArkSA)||void 0===e||null===(e=e.Base)||void 0===e?void 0:e.ProductId)>0||this.getQuantity(null==n||null===(t=n.ArkSA)||void 0===t||null===(t=t.Upgrade)||void 0===t?void 0:t.ProductId)>0||this.getQuantity(null==n||null===(i=n.ArkSA)||void 0===i||null===(i=i.Renewal)||void 0===i?void 0:i.ProductId)>0}},{key:"arkSAYears",get:function(){var e,t,i;return Math.min(this.getQuantity(null==n||null===(e=n.ArkSA)||void 0===e||null===(e=e.Base)||void 0===e?void 0:e.ProductId)+this.getQuantity(null==n||null===(t=n.ArkSA)||void 0===t||null===(t=t.Upgrade)||void 0===t?void 0:t.ProductId)+this.getQuantity(null==n||null===(i=n.ArkSA)||void 0===i||null===(i=i.Renewal)||void 0===i?void 0:i.ProductId),10)}},{key:"hasMinimalGames",get:function(){var e,t;return this.getQuantity(null==n||null===(e=n.BeaconMinimal)||void 0===e||null===(e=e.Base)||void 0===e?void 0:e.ProductId)>0||this.getQuantity(null==n||null===(t=n.BeaconMinimal)||void 0===t||null===(t=t.Renewal)||void 0===t?void 0:t.ProductId)>0}},{key:"minimalGamesYears",get:function(){var e,t;return Math.min(this.getQuantity(null==n||null===(e=n.BeaconMinimal)||void 0===e||null===(e=e.Base)||void 0===e?void 0:e.ProductId)+this.getQuantity(null==n||null===(t=n.BeaconMinimal)||void 0===t||null===(t=t.Renewal)||void 0===t?void 0:t.ProductId),10)}},{key:"build",value:function(e,t,i,a,r){this.reset(),this.isGift=t,i&&(t||null===e.arkLicense)&&this.setQuantity(n.Ark.Base.ProductId,1),a>0&&(a=Math.min(a,5),t?(i?this.setQuantity(n.ArkSA.Upgrade.ProductId,1):this.setQuantity(n.ArkSA.Base.ProductId,1),a>1&&this.setQuantity(n.ArkSA.Renewal.ProductId,a-1)):null!==e.arkSALicense?this.setQuantity(n.ArkSA.Renewal.ProductId,a):(i||null!==e.arkLicense?this.setQuantity(n.ArkSA.Upgrade.ProductId,1):this.setQuantity(n.ArkSA.Base.ProductId,1),a>1&&this.setQuantity(n.ArkSA.Renewal.ProductId,a-1))),r>0&&(r=Math.min(r,5),t?(this.setQuantity(n.BeaconMinimal.Base.ProductId,1),r>1&&this.setQuantity(n.BeaconMinimal.Renewal.ProductId,r-1)):null!==e.minimalGamesLicense?this.setQuantity(n.BeaconMinimal.Renewal.ProductId,r):(this.setQuantity(n.BeaconMinimal.Base.ProductId,1),r>1&&this.setQuantity(n.BeaconMinimal.Renewal.ProductId,r-1)))}},{key:"rebuild",value:function(e){var t=this.fingerprint;return this.build(e,this.isGift,this.hasArk,this.arkSAYears,this.minimalGamesYears),this.fingerprint!==t}},{key:"consume",value:function(e,t){if(t){if(this.isGift!==t.isGift)throw new Error("Cannot merge a gift item with a non-gift item.");var n=this.hasArk||t.hasArk,i=this.arkSAYears+t.arkSAYears,a=this.hasMinimalGames||t.hasMinimalGames;this.build(e,this.isGift,n,i,a)}}},{key:"total",get:function(){var e,t=0,n=A(this.productIds);try{for(n.s();!(e=n.n()).done;){var a=e.value;t+=i[a].Price*this.getQuantity(a)}}catch(e){n.e(e)}finally{n.f()}return t}}]),e}(),h=new WeakMap,m=new WeakMap,y=new WeakMap,g=new WeakMap,w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(B(this,e),L(this,h,{writable:!0,value:[]}),L(this,m,{writable:!0,value:null}),L(this,y,{writable:!0,value:!1}),L(this,g,{writable:!0,value:[]}),t)try{var n=JSON.parse(t);M(this,m,n.email),M(this,h,n.items.reduce((function(e,t){var n=new d(t);return n.count>0&&e.push(n),e}),[])),M(this,g,n.licenses)}catch(e){console.log("Failed to load saved cart")}}return I(e,[{key:"reset",value:function(){M(this,h,[]),M(this,m,null),M(this,y,!1),M(this,g,[]),this.save()}},{key:"toJSON",value:function(){return{email:G(this,m),items:G(this,h).reduce((function(e,t){return t.count>0&&e.push(t),e}),[]),licenses:G(this,g)}}},{key:"save",value:function(){localStorage.setItem("beaconCart",JSON.stringify(this))}},{key:"add",value:function(e){G(this,h).push(e),this.save()}},{key:"remove",value:function(e){M(this,h,G(this,h).filter((function(t){return t.id!==e.id}))),this.save()}},{key:"hasProduct",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=A(G(this,h));try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.getQuantity(e)>0&&a.isGift===n)return!0}}catch(e){i.e(e)}finally{i.f()}return!1}},{key:"email",get:function(){return G(this,m)}},{key:"setEmail",value:function(e){var t=this;return new Promise((function(i,a){var r=function(){var e,i=t.personalCartItem;return!!i&&(i.hasArk&&t.arkLicense?(i.setQuantity(null===(e=n.Ark)||void 0===e||null===(e=e.Base)||void 0===e?void 0:e.ProductId,0),0===i.count&&t.remove(i),!0):i.rebuild(t))};if(null===e){M(t,m,null),M(t,y,!1),M(t,g,[]);var o=r();return t.save(),void i({newEmail:null,cartChanged:o})}if(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).trim().toLowerCase())){var l=new URLSearchParams;l.append("email",e),c.get("/omni/lookup?".concat(l.toString())).then((function(n){var a=JSON.parse(n.body);M(t,m,a.email),M(t,y,a.verified),M(t,g,a.purchases);var o=r();t.save(),i({newEmail:e,cartChanged:o})})).catch((function(e){M(t,m,null),M(t,y,!1),M(t,g,[]),r(),t.save(),a(e.statusText)}))}else a("Address is not valid")}))}},{key:"emailVerified",get:function(){return G(this,y)}},{key:"checkingEmail",get:function(){return!1}},{key:"items",get:function(){return function(e){if(Array.isArray(e))return E(e)}(e=G(this,h))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||S(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();var e}},{key:"count",get:function(){return G(this,h).reduce((function(e,t){return t.count>0&&e++,e}),0)}},{key:"findLicense",value:function(e){var t,n=A(G(this,g));try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.productId===e)return i}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"arkLicense",get:function(){var e;return this.findLicense(null==n||null===(e=n.Ark)||void 0===e||null===(e=e.Base)||void 0===e?void 0:e.ProductId)}},{key:"arkSALicense",get:function(){var e;return this.findLicense(null==n||null===(e=n.ArkSA)||void 0===e||null===(e=e.Base)||void 0===e?void 0:e.ProductId)}},{key:"minimalGamesLicense",get:function(){var e;return this.findLicense(null==n||null===(e=n.BeaconMinimal)||void 0===e||null===(e=e.Base)||void 0===e?void 0:e.ProductId)}},{key:"ark2License",get:function(){return null}},{key:"personalCartItem",get:function(){var e,t=A(G(this,h));try{for(t.s();!(e=t.n()).done;){var n=e.value;if(!1===n.isGift)return n}}catch(e){t.e(e)}finally{t.f()}return null}},{key:"total",get:function(){var e,t=0,n=A(G(this,h));try{for(n.s();!(e=n.n()).done;)t+=e.value.total}catch(e){n.e(e)}finally{n.f()}return t}}],[{key:"load",value:function(){return new this(localStorage.getItem("beaconCart"))}}]),e}(),C=w.load(),P=new WeakMap,T=new WeakMap,j=function(){function e(t){B(this,e),L(this,P,{writable:!0,value:[]}),L(this,T,{writable:!0,value:null}),G(this,P).push(t)}return I(e,[{key:"currentView",get:function(){return G(this,P).slice(-1)}},{key:"back",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return!(G(this,P).length<=1||(this.switchView(G(this,P)[G(this,P).length-2],e),M(this,P,G(this,P).slice(0,G(this,P).length-2)),0))}},{key:"clearHistory",value:function(){G(this,P).length<=1||M(this,P,G(this,P).slice(-1))}},{key:"switchView",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.currentView!==e){G(this,T)&&(clearTimeout(G(this,T)),M(this,T,null));var i=document.getElementById(this.currentView),a=document.getElementById(e);G(this,P).push(e),n?(i.classList.add("invisible"),M(this,T,setTimeout((function(){i.classList.add("hidden"),a.classList.remove("hidden"),M(t,T,setTimeout((function(){a.classList.remove("invisible"),M(t,T,null)}),150))}),150))):(i.classList.add("hidden"),i.classList.add("invisible"),a.classList.remove("invisible"),a.classList.remove("hidden"))}}}]),e}();new j("checkout-wizard-start");var N=new j("page-landing"),z=document.getElementById("buy-button"),R=document.getElementById("cart-back-button"),Q=1===Object.keys(i).length,U=function(){document.title="Buy Beacon Omni",history.pushState({},"","/omni#checkout"),dispatchEvent(new PopStateEvent("popstate",{}))},H={cancelButton:document.getElementById("checkout-email-cancel"),actionButton:document.getElementById("checkout-email-action"),emailField:document.getElementById("checkout-email-field"),errorField:document.getElementById("checkout-email-error"),allowsSkipping:!1,successFunction:function(e){},init:function(){var e=this,t=function(t){e.actionButton.disabled=!0,e.cancelButton.disabled=!0,e.errorField.classList.add("hidden"),C.setEmail(t).then((function(t){t.newEmail;var n=t.cartChanged;a.hideModal(),setTimeout((function(){e.successFunction(n)}),310)})).catch((function(t){e.errorField.innerText=t,e.errorField.classList.remove("hidden")})).finally((function(){e.actionButton.disabled=!1,e.cancelButton.disabled=!1}))};this.actionButton.addEventListener("click",(function(n){n.preventDefault(),t(e.emailField.value)})),this.cancelButton.addEventListener("click",(function(n){n.preventDefault(),e.allowsSkipping?t(null):a.hideModal()}))},present:function(e,n){t.forceEmail?C.setEmail(t.forceEmail).then((function(e){e.newEmail;var t=e.cartChanged;n(t)})):(this.allowsSkipping=e,this.successFunction=n,C.email?this.emailField.value=C.email:this.emailField.value=sessionStorage.getItem("email")||localStorage.getItem("email")||"",this.cancelButton.innerText=e?"Skip For Now":"Cancel",a.showModal("checkout-email"))}};H.init();var V={cartView:null,editCartItem:null,actionButton:document.getElementById("checkout-wizard-action"),arkCheck:document.getElementById("checkout-wizard-ark-check"),arkOnlyCheck:document.getElementById("storefront-ark-check"),arkOnlyGiftDownButton:document.getElementById("storefront-ark-gift-decrease"),arkOnlyGiftField:document.getElementById("storefront-ark-gift-field"),arkOnlyGiftQuantityGroup:document.getElementById("storefront-ark-gift-group"),arkOnlyGiftUpButton:document.getElementById("storefront-ark-gift-increase"),arkOnlyOwnedField:document.getElementById("storefront-ark-owned"),arkPriceField:document.getElementById("checkout-wizard-ark-price"),arkSACheck:document.getElementById("checkout-wizard-arksa-check"),arkSADurationDownButton:document.getElementById("checkout-wizard-arksa-yeardown-button"),arkSADurationField:document.getElementById("checkout-wizard-arksa-duration-field"),arkSADurationGroup:document.getElementById("checkout-wizard-arksa-duration-group"),arkSADurationUpButton:document.getElementById("checkout-wizard-arksa-yearup-button"),arkSAPriceField:document.getElementById("checkout-wizard-arksa-full-price"),arkSAPromoField:document.getElementById("checkout-wizard-promo-arksa"),arkSAStatusField:document.getElementById("checkout-wizard-status-arksa"),arkSAUpgradePriceField:document.getElementById("checkout-wizard-arksa-discount-price"),arkStatusField:document.getElementById("checkout-wizard-status-ark"),giftCheck:document.getElementById("checkout-wizard-gift-check"),minimalGamesCheck:document.getElementById("checkout-wizard-beaconminimal-check"),minimalGamesDurationDownButton:document.getElementById("checkout-wizard-beaconminimal-yeardown-button"),minimalGamesDurationField:document.getElementById("checkout-wizard-beaconminimal-duration-field"),minimalGamesDurationGroup:document.getElementById("checkout-wizard-beaconminimal-duration-group"),minimalGamesDurationUpButton:document.getElementById("checkout-wizard-beaconminimal-yearup-button"),minimalGamesPriceField:document.getElementById("checkout-wizard-beaconminimal-price"),minimalGamesStatusField:document.getElementById("checkout-wizard-status-beaconminimal"),cancelButton:document.getElementById("checkout-wizard-cancel"),init:function(e){var t=this;if(this.cartView=e,this.cancelButton&&this.cancelButton.addEventListener("click",(function(e){e.preventDefault(),a.hideModal()})),this.actionButton&&this.actionButton.addEventListener("click",(function(e){e.preventDefault();var n=t.giftCheck.checked,i=t.arkCheck&&!1===t.arkCheck.disabled&&t.arkCheck.checked,r=t.arkSACheck&&!1===t.arkSACheck.disabled&&t.arkSACheck.checked,o=t.minimalGamesCheck&&!1===t.minimalGamesCheck.disabled&&t.minimalGamesCheck.checked;if(!1!==(i||r||o)){var c,l=r?parseInt(t.arkSADurationField.value)||1:0,s=o?parseInt(t.minimalGamesDurationField.value)||1:0;if(t.editCartItem?c=t.editCartItem:(c=new d).isGift=n,c.build(C,n,i,l,s),!1===Boolean(t.editCartItem)){var u=C.personalCartItem;!1===n&&!0===Boolean(u)?u.consume(C,c):C.add(c)}C.save(),t.cartView.update(),U(),a.hideModal()}})),this.giftCheck&&this.giftCheck.addEventListener("change",(function(){t.update()})),this.arkCheck&&this.arkCheck.addEventListener("change",(function(){t.update()})),this.arkSACheck&&this.arkSADurationField&&this.arkSADurationUpButton&&this.arkSADurationDownButton&&this.arkSADurationGroup){this.arkSACheck.addEventListener("change",(function(){t.update()})),this.arkSADurationField.addEventListener("input",(function(){t.update()}));var n=function(e){var n=parseInt(t.arkSADurationField.value),i=n+e;(i>5||i<1)&&(t.arkSADurationGroup.classList.add("shake"),setTimeout((function(){t.arkSADurationGroup.classList.remove("shake")}),400),i=Math.max(Math.min(i,5),1)),n!==i&&(t.arkSADurationField.value=i,t.arkSACheck.checked=!0,t.update())};this.arkSADurationUpButton.addEventListener("click",(function(e){e.preventDefault(),n(1)})),this.arkSADurationDownButton.addEventListener("click",(function(e){e.preventDefault(),n(-1)}))}if(this.minimalGamesCheck&&this.minimalGamesDurationField&&this.minimalGamesDurationUpButton&&this.minimalGamesDurationDownButton&&this.minimalGamesDurationGroup){this.minimalGamesCheck.addEventListener("change",(function(){t.update()})),this.minimalGamesDurationField.addEventListener("input",(function(){t.update()}));var i=function(e){var n=parseInt(t.minimalGamesDurationField.value),i=n+e;(i>5||i<1)&&(t.minimalGamesDurationGroup.classList.add("shake"),setTimeout((function(){t.minimalGamesDurationGroup.classList.remove("shake")}),400),i=Math.max(Math.min(i,5),1)),n!==i&&(t.minimalGamesDurationField.value=i,t.minimalGamesCheck.checked=!0,t.update())};this.minimalGamesDurationUpButton.addEventListener("click",(function(e){e.preventDefault(),i(1)})),this.minimalGamesDurationDownButton.addEventListener("click",(function(e){e.preventDefault(),i(-1)}))}if(this.arkOnlyCheck&&this.arkOnlyCheck.addEventListener("change",(function(e){if(e.preventDefault(),e.currentTarget.checked){var n=C.personalCartItem;n||(n=new d,C.add(n)),n.build(C,!1,!0,0),C.save()}else{var i=C.personalCartItem;i&&C.remove(i)}t.cartView.update()})),this.arkOnlyGiftField){var r=function(e){var n=C.items.filter((function(e){return!0===e.isGift&&e.hasArk}));if(n.length!==e){if(n.length>e)for(var i=e;i<=n.length-1;i++)C.remove(n[i]);else if(n.length<e)for(var a=n.length;a<e;a++){var r=new d;r.build(C,!0,!0,0),C.add(r)}t.cartView.update()}};this.arkOnlyGiftField.addEventListener("input",(function(e){var t=Math.min(Math.max(parseInt(e.currentTarget.value),0),5);r(t)})),this.arkOnlyGiftField.addEventListener("blur",(function(){t.cartView.update()}));var o=function(e){var n=parseInt(t.arkOnlyGiftField.value),i=n+e;(i>5||i<0)&&(t.arkOnlyGiftQuantityGroup.classList.add("shake"),setTimeout((function(){t.arkOnlyGiftQuantityGroup.classList.remove("shake")}),400),i=Math.max(Math.min(i,5),0)),n!==i&&(t.arkOnlyGiftField.value=i,r(i))};this.arkOnlyGiftUpButton.addEventListener("click",(function(e){e.preventDefault(),o(1)})),this.arkOnlyGiftDownButton.addEventListener("click",(function(e){e.preventDefault(),o(-1)}))}},present:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.editCartItem=e,this.arkCheck.disabled=!1,this.arkSACheck&&(this.arkSACheck.disabled=!1),this.minimalGamesCheck&&(this.minimalGamesCheck.disabled=!1),e?(this.giftCheck.checked=e.isGift,this.giftCheck.disabled=!0,this.arkCheck.checked=e.hasArk,this.arkSACheck&&(this.arkSACheck.checked=e.hasArkSA),this.minimalGamesCheck&&(this.minimalGamesCheck.checked=e.hasMinimalGames)):(this.giftCheck.checked=!1,this.giftCheck.disabled=!1,this.arkCheck.checked=!1,this.arkSACheck&&(this.arkSACheck.checked=!1),this.minimalGamesCheck&&(this.minimalGamesCheck.checked=!1)),this.arkSADurationField&&(this.arkSADurationField.value=e?e.arkSAYears:"1"),this.minimalGamesDurationField&&(this.minimalGamesDurationField.value=e?e.minimalGamesYears:"1"),this.cancelButton.innerText="Cancel",this.update(),a.showModal("checkout-wizard")},getGameStatus:function(){var e={Ark:D,ArkSA:D,BeaconMinimal:D},t=C.personalCartItem,n=Boolean(this.editCartItem);return this.giftCheck&&this.giftCheck.checked?(e.Ark=this.arkCheck&&!1===this.arkCheck.disabled&&this.arkCheck.checked?O:D,e.ArkSA=this.arkSACheck&&!1===this.arkSACheck.disabled&&this.arkSACheck.checked?O:D,e.BeaconMinimal=this.minimalGamesCheck=!1===this.minimalGamesCheck.disabled&&this.minimalGamesCheck.checked?O:D):(C.arkLicense?e.Ark=x:t&&(!1===n||t.id!==this.editCartItem.id)&&t.hasArk?e.Ark=F:this.arkCheck&&!1===this.arkCheck.disabled&&this.arkCheck.checked?e.Ark=O:e.Ark=D,C.arkSALicense?e.ArkSA=x:t&&(!1===n||t.id!==this.editCartItem.id)&&t.hasArkSA?e.ArkSA=F:this.arkSACheck&&this.arkSACheck&&!1===this.arkSACheck.disabled&&this.arkSACheck.checked?e.ArkSA=O:e.ArkSA=D,C.minimalGamesLicense?e.BeaconMinimal=x:t&&(!1===n||t.id!==this.editCartItem.id)&&t.hasMinimalGames()?e.BeaconMinimal=F:this.minimalGamesCheck&&this.minimalGamesCheck&&!1===this.minimalGamesCheck.disabled&&this.minimalGamesCheck.checked?e.BeaconMinimal=O:e.BeaconMinimal=D),e},update:function(){var e=this.getGameStatus(),t=0;if(this.arkCheck&&!1===this.arkCheck.disabled&&!0===this.arkCheck.checked&&(t+=n.Ark.Base.Price),this.arkSACheck){var i=n.ArkSA.Base.Price,a=n.ArkSA.Base.Price,o=Math.min(Math.max(parseInt(this.arkSADurationField.value)||1,1),5);parseInt(this.arkSADurationField.value)!==o&&document.activeElement!==this.arkSADurationField&&(this.arkSADurationField.value=o);var c=Math.max(o-1,0),l=Math.round((n.ArkSA.Base.Price-n.ArkSA.Upgrade.Price)/n.ArkSA.Base.Price*100);if(this.arkSAPromoField.innerText="".concat(l,"% off first year when bundled with ").concat(n.Ark.Base.Name),e.ArkSA===x){var s,u=C.arkSALicense,d=Math.floor(Date.now()/1e3),h=u.expiresEpoch,m=p(v(h),!1),f=(d>h?86400*Math.floor(d/86400)+86400:h)+n.ArkSA.Renewal.PlanLengthSeconds*o,k=p(v(f),!1);s=d>h?'Renew your update plan<br>Expired on <span class="text-red">'.concat(m,'</span><br>New expiration: <span class="text-green">').concat(k,"</span>"):'Extend your update plan<br>Expires on <span class="text-green">'.concat(m,'</span><br>New expiration: <span class="text-green">').concat(k,"</span>"),this.arkSAStatusField.innerHTML=s,a=i=n.ArkSA.Renewal.Price*o,this.arkSAPromoField.innerText="",this.arkSAPromoField.classList.add("hidden")}else if(e.ArkSA===F)a=i=n.ArkSA.Renewal.Price*o,this.arkSAStatusField.innerText="Additional renewal years for ".concat(n.ArkSA.Base.Name," in your cart."),this.arkSAPromoField.innerText="",this.arkSAPromoField.classList.add("hidden");else if(e.Ark!==D){i=n.ArkSA.Base.Price+n.ArkSA.Renewal.Price*c,a=n.ArkSA.Upgrade.Price+n.ArkSA.Renewal.Price*c;var y=e.Ark===x?"because you own":"when bundled with";this.arkSAStatusField.innerText="Includes first year of app updates. Additional years cost ".concat(r(n.ArkSA.Renewal.Price)," each."),this.arkSAPromoField.innerText="".concat(l,"% off first year ").concat(y," ").concat(n.Ark.Base.Name),this.arkSAPromoField.classList.remove("hidden")}else this.arkSAStatusField.innerText="Includes first year of app updates. Additional years cost ".concat(r(n.ArkSA.Renewal.Price)," each."),this.arkSAPromoField.innerText="".concat(l,"% off first year when bundled with ").concat(n.Ark.Base.Name),this.arkSAPromoField.classList.remove("hidden"),a=i=n.ArkSA.Base.Price+n.ArkSA.Renewal.Price*c;this.arkSAPriceField.classList.toggle("checkout-wizard-discounted",i!==a),this.arkSAPriceField.innerText=r(i),this.arkSAUpgradePriceField.classList.toggle("hidden",i===a),this.arkSAUpgradePriceField.innerText=r(a),!1===this.arkSACheck.disabled&&!0===this.arkSACheck.checked&&(t+=a)}if(e.Ark===x?(this.arkStatusField.innerText="You already own ".concat(n.Ark.Base.Name,"."),this.arkCheck.disabled=!0,this.arkCheck.checked=!1):e.Ark===F?(this.arkStatusField.innerText="".concat(n.Ark.Base.Name," is already in your cart."),this.arkCheck.disabled=!0,this.arkCheck.checked=!1):(this.arkStatusField.innerText="Includes lifetime app updates.",this.arkCheck.disabled=!1),this.minimalGamesCheck){var g=n.BeaconMinimal.Base.Price,b=Math.min(Math.max(parseInt(this.minimalGamesDurationField.value)||1,1),5);parseInt(this.minimalGamesDurationField.value)!==b&&document.activeElement!==this.minimalGamesDurationField&&(this.minimalGamesDurationField.value=b);var w=Math.max(b-1,0);if(e.BeaconMinimal===x){var A,S=C.minimalGamesLicense,E=Math.floor(Date.now()/1e3),B=S.expiresEpoch,I=p(v(B),!1),P=(E>B?86400*Math.floor(E/86400)+86400:B)+n.BeaconMinimal.Renewal.PlanLengthSeconds*b,L=p(v(P),!1);A=E>B?'Renew your update plan<br>Expired on <span class="text-red">'.concat(I,'</span><br>New expiration: <span class="text-green">').concat(L,"</span>"):'Extend your update plan<br>Expires on <span class="text-green">'.concat(I,'</span><br>New expiration: <span class="text-green">').concat(L,"</span>"),this.minimalGamesStatusField.innerHTML=A,g=n.BeaconMinimal.Renewal.Price*b}else e.BeaconMinimal===F?(g=n.BeaconMinimal.Renewal.Price*b,this.minimalGamesStatusField.innerText="Additional renewal years for ".concat(n.BeaconMinimal.Base.Name," in your cart.")):(this.minimalGamesStatusField.innerText="For games with only a few options, such as Palworld. Includes first year of app updates. Additional years cost ".concat(r(n.BeaconMinimal.Renewal.Price)," each."),g=n.BeaconMinimal.Base.Price+n.BeaconMinimal.Renewal.Price*w);this.minimalGamesPriceField.innerText=r(g),!1===this.minimalGamesCheck.disabled&&!0===this.minimalGamesCheck.checked&&(t+=g)}var G=this.editCartItem?"Edit":"Add to Cart";t>0?(this.actionButton.disabled=!1,this.actionButton.innerText="".concat(G,": ").concat(r(t))):(this.actionButton.disabled=!0,this.actionButton.innerText=G)}},Y={wizard:null,emailField:document.getElementById("storefront-cart-header-email-field"),changeEmailButton:document.getElementById("storefront-cart-header-email-button"),currencyMenu:document.getElementById("storefront-cart-currency-menu"),addMoreButton:document.getElementById("storefront-cart-more-button"),checkoutButton:document.getElementById("storefront-cart-checkout-button"),refundCheckbox:document.getElementById("storefront-refund-checkbox"),footer:document.getElementById("storefront-cart-footer"),body:document.getElementById("storefront-cart"),totalField:document.getElementById("storefront-cart-total"),init:function(e){var t=this;this.wizard=e,this.currencyMenu.addEventListener("change",(function(e){e.preventDefault(),c.get("/omni/currency?currency=".concat(e.target.value)).then((function(){window.location.reload()})).catch((function(e){console.log(JSON.stringify(e)),a.show("Currency was not changed",e.statusText)}))})),this.addMoreButton.addEventListener("click",(function(e){e.preventDefault(),t.wizard.present()})),this.checkoutButton.addEventListener("click",(function(e){e.preventDefault();var n=t.refundCheckbox.checked,i=function(e){t.update(),e?C.count>0?a.show("Your cart contents have changed.","The items in your cart have changed based on your e-mail address. Please review before continuing checkout."):a.show("Your cart is now empty.","You already own everything in your cart. There is no need to purchase again."):(t.checkoutButton.disabled=!0,c.post("/omni/begin",b(b({},C.toJSON()),{},{refundPolicyAgreed:n})).then((function(e){try{var t=JSON.parse(e.body),n=t.url;sessionStorage.setItem("clientReferenceId",t.client_reference_id),window.location=n}catch(t){console.log(e.body),a.show("Unknown Error","There was an unknown error while starting the checkout process.")}})).catch((function(e){try{var t=JSON.parse(e.body).message;a.show("Checkout Error",t)}catch(t){console.log(e.body),a.show("Unknown Error","There was an unknown error while starting the checkout process.")}})).finally((function(){t.checkoutButton.disabled=!1})))};C.email?n?i(!1):a.show("Hang on","Please agree to the refund policy."):H.present(!1,i)})),this.changeEmailButton.addEventListener("click",(function(e){e.preventDefault(),H.present(!1,(function(){t.update()}))})),this.update()},update:function(){var e,n=this;if(Q){this.emailField.innerText=C.email,this.changeEmailButton.disabled=Boolean(t.forceEmail),this.changeEmailButton.innerText=C.email?"Change Email":"Set Email",this.changeEmailButton.classList.remove("hidden"),this.addMoreButton.classList.add("hidden"),C.arkLicense?(this.wizard.arkOnlyOwnedField.classList.remove("hidden"),this.wizard.arkOnlyCheck.parentElement.classList.add("hidden")):(this.wizard.arkOnlyOwnedField.classList.add("hidden"),this.wizard.arkOnlyCheck.parentElement.classList.remove("hidden"));var i=C.personalCartItem;if(this.wizard.arkOnlyCheck.checked=i&&i.hasArk,document.activeElement!==this.wizard.arkOnlyGiftField){var a=C.items.filter((function(e){return!0===e.isGift&&e.hasArk}));this.wizard.arkOnlyGiftField.value=a.length}}else if(C.count>0)this.emailField.innerText=C.email,this.changeEmailButton.disabled=Boolean(t.forceEmail),this.changeEmailButton.innerText=C.email?"Change Email":"Set Email",this.changeEmailButton.classList.remove("hidden"),this.body.innerText="",this.body.classList.remove("empty"),this.footer.classList.remove("hidden"),C.items.forEach((function(e){var t=n.createCartItemRow(e);t&&n.body.appendChild(t)})),z.innerText="Go to Cart";else{this.emailField.innerText="",this.changeEmailButton.classList.add("hidden"),this.body.innerText="",this.body.classList.add("empty"),this.footer.classList.add("hidden"),this.body.appendChild(document.createElement("div"));var r=document.createElement("div"),o=document.createElement("p");o.appendChild(document.createTextNode("Your cart is empty.")),r.appendChild(o),this.buyMoreButton=document.createElement("button"),this.buyMoreButton.addEventListener("click",(function(){H.present(!0,(function(){n.wizard.present()}))})),this.buyMoreButton.classList.add("default"),this.buyMoreButton.appendChild(document.createTextNode("Buy Omni"));var c=document.createElement("p");c.appendChild(this.buyMoreButton),r.appendChild(c),this.body.appendChild(r),this.body.appendChild(document.createElement("div")),z.innerText="Buy Omni"}this.totalField.setAttribute("beacon-price",C.total),e=t.currencyCode,document.querySelectorAll(".formatted-price").forEach((function(t){var n,i=parseFloat(null!==(n=t.getAttribute("beacon-price"))&&void 0!==n?n:t.innerText),a=t.getAttribute("beacon-currency"),r=k(null!=a?a:e);r&&(t.innerText=r(i))})),this.checkoutButton.disabled=0===C.total},createProductRow:function(e,t){var n=e.getQuantity(t);if(n<=0)return null;var a=i[t].Name,r=i[t].Price,o=document.createElement("div");o.appendChild(document.createTextNode(n));var c=document.createElement("div");c.appendChild(document.createTextNode(a));var l=document.createElement("div");l.classList.add("formatted-price"),l.appendChild(document.createTextNode(r*n));var s=document.createElement("div");return s.classList.add("bundle-product"),s.appendChild(o),s.appendChild(c),s.appendChild(l),s},createCartItemRow:function(e){var t=this,n=e.productIds;if(n.length<=0)return null;var i=document.createElement("div");i.classList.add("bundle"),n.forEach((function(n){var a=t.createProductRow(e,n);a&&i.appendChild(a)}));var a=document.createElement("div");e.isGift&&(i.classList.add("gift"),a.classList.add("gift"),n.length>1?a.appendChild(document.createTextNode("These products are a gift. You will receive a gift code for them.")):a.appendChild(document.createTextNode("This product is a gift. You will receive a gift code for it.")));var r=document.createElement("button");r.appendChild(document.createTextNode("Edit")),r.classList.add("small"),r.addEventListener("click",(function(n){n.preventDefault(),t.wizard.present(e)}));var o=document.createElement("button");o.appendChild(document.createTextNode("Remove")),o.classList.add("red"),o.classList.add("small"),o.addEventListener("click",(function(n){n.preventDefault(),C.remove(e),t.update()}));var c=document.createElement("div");c.classList.add("button-group"),c.appendChild(r),c.appendChild(o);var l=document.createElement("div");l.appendChild(c);var s=document.createElement("div");return s.classList.add("actions"),s.classList.add("double-group"),s.appendChild(a),s.appendChild(l),i.appendChild(s),i}};V.init(Y),Y.init(V);var W=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=window.location.hash.substring(1);if(o&&o.hasPage(t))return"page-landing"!==N.currentView&&N.back(e),void o.switchPage(t);window.scrollTo(window.scrollX,0),"#checkout"===window.location.hash?N.switchView("page-cart",e):N.back(e)};z.addEventListener("click",(function(e){e.preventDefault(),Q||C.count>0?U():H.present(!0,(function(){V.present()}))})),R.addEventListener("click",(function(){o?(o.currentPageTitle?document.title="Beacon Omni for ".concat(o.currentPageTitle):document.title="Beacon Omni",history.pushState({},"","/omni#".concat(o.currentPageName))):(document.title="Beacon Omni",history.pushState({},"","/omni")),dispatchEvent(new PopStateEvent("popstate",{}))})),window.addEventListener("popstate",(function(){W(!0)})),W(!1),t.forceEmail&&(C.email!==t.forceEmail&&C.reset(),0===C.count?H.present(!0,(function(){V.present()})):U())}))})();