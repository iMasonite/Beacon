#tag DesktopWindow
Begin ArkSAConfigEditor ArkSAStatLimitsEditor
   AllowAutoDeactivate=   True
   AllowFocus      =   False
   AllowFocusRing  =   False
   AllowTabs       =   True
   Backdrop        =   0
   BackgroundColor =   &cFFFFFF00
   Composited      =   False
   Enabled         =   True
   HasBackgroundColor=   False
   Height          =   516
   Index           =   -2147483648
   InitialParent   =   ""
   Left            =   0
   LockBottom      =   True
   LockLeft        =   True
   LockRight       =   True
   LockTop         =   True
   TabIndex        =   0
   TabPanelIndex   =   0
   TabStop         =   True
   Tooltip         =   ""
   Top             =   0
   Transparent     =   True
   Visible         =   True
   Width           =   999
   Begin DesktopCheckBox StatCheckboxes
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Generic Quality"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   0
      InitialParent   =   ""
      Italic          =   False
      Left            =   348
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   10
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   129
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   True
      VisualState     =   0
      Width           =   142
   End
   Begin DesktopCheckBox StatCheckboxes
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Armor"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   1
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   0
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   61
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   True
      VisualState     =   0
      Width           =   142
   End
   Begin DesktopCheckBox StatCheckboxes
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Durability"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   2
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   4
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   95
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   True
      VisualState     =   0
      Width           =   142
   End
   Begin DesktopCheckBox StatCheckboxes
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Damage"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   3
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   8
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   129
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   True
      VisualState     =   0
      Width           =   142
   End
   Begin DesktopCheckBox StatCheckboxes
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Ammo"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   4
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   12
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   163
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   True
      VisualState     =   0
      Width           =   142
   End
   Begin DesktopCheckBox StatCheckboxes
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Hypothermal"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   5
      InitialParent   =   ""
      Italic          =   False
      Left            =   348
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   2
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   61
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   True
      VisualState     =   0
      Width           =   142
   End
   Begin DesktopCheckBox StatCheckboxes
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Weight"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   6
      InitialParent   =   ""
      Italic          =   False
      Left            =   348
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   14
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   163
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   True
      VisualState     =   0
      Width           =   142
   End
   Begin DesktopCheckBox StatCheckboxes
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Hyperthermal"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   7
      InitialParent   =   ""
      Italic          =   False
      Left            =   348
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   6
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   95
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   True
      VisualState     =   0
      Width           =   142
   End
   Begin UITweaks.ResizedTextField StatFields
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   0
      Italic          =   False
      Left            =   502
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   11
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   2
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   129
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   121
   End
   Begin UITweaks.ResizedTextField StatFields
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   1
      Italic          =   False
      Left            =   174
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   1
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   2
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   61
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   121
   End
   Begin UITweaks.ResizedTextField StatFields
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   2
      Italic          =   False
      Left            =   174
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   5
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   2
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   95
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   121
   End
   Begin UITweaks.ResizedTextField StatFields
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   3
      Italic          =   False
      Left            =   174
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   9
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   2
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   129
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   121
   End
   Begin UITweaks.ResizedTextField StatFields
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   4
      Italic          =   False
      Left            =   174
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   13
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   2
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   163
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   121
   End
   Begin UITweaks.ResizedTextField StatFields
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   5
      Italic          =   False
      Left            =   502
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   3
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   2
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   61
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   121
   End
   Begin UITweaks.ResizedTextField StatFields
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   6
      Italic          =   False
      Left            =   502
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   15
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   2
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   163
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   121
   End
   Begin UITweaks.ResizedTextField StatFields
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   7
      Italic          =   False
      Left            =   502
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   7
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   2
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   95
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   121
   End
   Begin BeaconListbox PreviewList
      AllowAutoDeactivate=   True
      AllowAutoHideScrollbars=   True
      AllowExpandableRows=   False
      AllowFocusRing  =   True
      AllowInfiniteScroll=   False
      AllowResizableColumns=   False
      AllowRowDragging=   False
      AllowRowReordering=   False
      Bold            =   False
      ColumnCount     =   9
      ColumnWidths    =   "*,75,75,75,75,75,75,75,75"
      DefaultRowHeight=   26
      DefaultSortColumn=   0
      DefaultSortDirection=   0
      DropIndicatorVisible=   False
      EditCaption     =   "Edit"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      GridLineStyle   =   0
      HasBorder       =   True
      HasHeader       =   True
      HasHorizontalScrollbar=   False
      HasVerticalScrollbar=   True
      HeadingIndex    =   -1
      Height          =   257
      Index           =   -2147483648
      InitialParent   =   ""
      InitialValue    =   "Item	Armor	Durability	Damage	Ammo	Hypo	Hyper	Generic	Weight"
      Italic          =   False
      Left            =   20
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      PageSize        =   100
      PreferencesKey  =   ""
      RequiresSelection=   False
      RowSelectionType=   0
      Scope           =   2
      TabIndex        =   17
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   239
      TotalPages      =   -1
      Transparent     =   False
      TypeaheadColumn =   0
      Underline       =   False
      Visible         =   True
      VisibleRowCount =   0
      Width           =   959
      _ScrollOffset   =   0
      _ScrollWidth    =   -1
   End
   Begin UITweaks.ResizedLabel CautionLabel
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   True
      Left            =   307
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   16
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "The items shown here are examples. Stat limits will permanently affect all items in the game."
      TextAlignment   =   3
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   205
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   672
   End
   Begin OmniBar ConfigToolbar
      Alignment       =   0
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      BackgroundColor =   ""
      ContentHeight   =   0
      Enabled         =   True
      Height          =   41
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   0
      LeftPadding     =   -1
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      RightPadding    =   -1
      Scope           =   2
      ScrollActive    =   False
      ScrollingEnabled=   False
      ScrollSpeed     =   20
      TabIndex        =   18
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   0
      Transparent     =   True
      Visible         =   True
      Width           =   999
   End
   Begin DelayedSearchField FilterField
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowRecentItems=   False
      AllowTabStop    =   True
      ClearMenuItemValue=   "Clear"
      DelayPeriod     =   250
      Enabled         =   True
      Height          =   22
      Hint            =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumRecentItems=   -1
      RecentItemsValue=   "Recent Searches"
      Scope           =   2
      TabIndex        =   19
      TabPanelIndex   =   0
      Text            =   ""
      Tooltip         =   ""
      Top             =   205
      Transparent     =   False
      Visible         =   True
      Width           =   275
   End
End
#tag EndDesktopWindow

#tag WindowCode
	#tag Event
		Sub Opening()
		  Self.MinimumWidth = 717
		End Sub
	#tag EndEvent

	#tag Event
		Sub SetupUI()
		  Var Config As ArkSA.Configs.StatLimits = Self.Config(False)
		  For Stat As Integer = ArkSA.EngramStat.FirstIndex To ArkSA.EngramStat.LastIndex
		    Var Value As NullableDouble = Config.Value(Stat)
		    If Value = Nil Then
		      Self.StatCheckboxes(Stat).Value = False
		      Self.StatFields(Stat).Text = ""
		    Else
		      Self.StatCheckboxes(Stat).Value = True
		      Var DoubleValue As Double = Value
		      Self.StatFields(Stat).Text = DoubleValue.PrettyText(0, True)
		    End If
		  Next
		  
		  Self.UpdateList()
		End Sub
	#tag EndEvent


	#tag Method, Flags = &h21
		Private Shared Function ColumnIsPercentage(Column As Integer) As Boolean
		  Select Case Column
		  Case ColumnDamage, ColumnGeneric, ColumnAmmo
		    Return True
		  End Select
		  
		  Return False
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Shared Function ColumnToStat(Column As Integer) As Integer
		  Select Case Column
		  Case ColumnAmmo
		    Return ArkSA.EngramStat.IndexWeaponAmmo
		  Case ColumnArmor
		    Return ArkSA.EngramStat.IndexArmor
		  Case ColumnDamage
		    Return ArkSA.EngramStat.IndexWeaponDamage
		  Case ColumnDurability
		    Return ArkSA.EngramStat.IndexMaxDurability
		  Case ColumnGeneric
		    Return ArkSA.EngramStat.IndexGenericQuality
		  Case ColumnHyper
		    Return ArkSA.EngramStat.IndexHyperthermal
		  Case ColumnHypo
		    Return ArkSA.EngramStat.IndexHypothermal
		  Case ColumnWeight
		    Return ArkSA.EngramStat.IndexWeight
		  End Select
		End Function
	#tag EndMethod

	#tag Method, Flags = &h1
		Protected Function Config(ForWriting As Boolean) As ArkSA.Configs.StatLimits
		  Return ArkSA.Configs.StatLimits(Super.Config(ForWriting))
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Function InternalName() As String
		  Return ArkSA.Configs.NameStatLimits
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Shared Function StatToColumn(Stat As Integer) As Integer
		  Select Case Stat
		  Case ArkSA.EngramStat.IndexArmor
		    Return ColumnArmor
		  Case ArkSA.EngramStat.IndexGenericQuality
		    Return ColumnGeneric
		  Case ArkSA.EngramStat.IndexHyperthermal
		    Return ColumnHyper
		  Case ArkSA.EngramStat.IndexHypothermal
		    Return ColumnHypo
		  Case ArkSA.EngramStat.IndexMaxDurability
		    Return ColumnDurability
		  Case ArkSA.EngramStat.IndexWeaponAmmo
		    Return ColumnAmmo
		  Case ArkSA.EngramStat.IndexWeaponDamage
		    Return ColumnDamage
		  Case ArkSA.EngramStat.IndexWeight
		    Return ColumnWeight
		  End Select
		End Function
	#tag EndMethod

	#tag Method, Flags = &h1
		Protected Sub UpdateList()
		  Var Filter As String = Self.FilterField.Text.Trim
		  Var Engrams() As ArkSA.Engram
		  Var DataSource As ArkSA.DataSource = ArkSA.DataSource.Pool.Get(False)
		  If Filter.IsEmpty = False Then
		    Engrams = DataSource.GetEngrams(Filter, Self.Project.ContentPacks)
		  Else
		    Static EngramIds() As String
		    If EngramIds.Count = 0 Then
		      EngramIds.Add("3dd1df4a-180d-5c7c-8a73-0c3487b0a5bf") // Bow
		      EngramIds.Add("f47bc00c-f2e1-5fb6-8847-9805f623a596") // Crossbow
		      EngramIds.Add("8b59e9dc-cd7c-5f8b-91ed-913a29b2f797") // Compound Bow
		      EngramIds.Add("24980d6d-802c-5466-8d51-6fc115ce673b") // Assault Rifle
		      EngramIds.Add("554fbd13-daeb-59e5-bf33-853c7c965f2d") // Longneck Rifle
		      EngramIds.Add("ab9bc82b-3a88-53b6-ab95-d5a6788e0b16") // Fabricated Sniper Rifle
		      EngramIds.Add("e2bb9163-f48b-5550-8316-d7dca8633b36") // Simple Pistol
		      EngramIds.Add("82748d15-a3bd-50f9-9a31-7492b8515e11") // Fabricated Pistol
		      EngramIds.Add("ee8fd357-7a4f-550e-a0b3-d782bebb2a33") // Shotgun
		      EngramIds.Add("7456cdc2-c5fe-5eec-be53-1686f21b0f2b") // Pump Shotgun
		      EngramIds.Add("7cddfb0b-9324-53c8-9e15-9ca09b51e235") // Tek Rifle
		      EngramIds.Add("d35d97ff-1f4b-4925-9956-61a61ae607e8") // Railgun
		      EngramIds.Add("ac748d72-01ff-48b5-a355-142145d5b13f") // Tek Bow
		      EngramIds.Add("39b6d260-a7fb-418c-8112-f554a551238d") // Tek Pistol
		      EngramIds.Add("7618efa9-7a1e-5ba9-b9a7-939bd980656a") // Cloth Shirt
		      EngramIds.Add("684b5ba4-b656-4bcf-9f58-e8c506bc108c") // Desert Cloth Shirt
		      EngramIds.Add("f21f8067-76c5-5ba1-87cd-96404af23c16") // Hide Shirt
		      EngramIds.Add("ca1e2884-6c95-55d0-b9fb-677d3d39acd1") // Chitin Chestpiece
		      EngramIds.Add("cb165ce1-846c-516f-9bdf-5f305ae77785") // Fur Chestpiece
		      EngramIds.Add("754d03a8-b1bf-5731-b9d0-ab915d6930f2") // SCUBA Tank
		      EngramIds.Add("293c9a0e-498c-4ed2-a66a-619672e441f7") // Hazard Shirt
		      EngramIds.Add("21e2c27f-5326-5418-8e64-bbede6dcde86") // Flak Chestpiece
		      EngramIds.Add("cf0705a1-180e-59a3-9bf0-560eb3d7b883") // Riot Chestpiece
		      EngramIds.Add("18524e8a-ff2e-5d62-a3a9-f105eba01306") // Tek Chestpiece
		      EngramIds.Add("9cd3913c-19a6-50cf-94f2-63a57f043f7e") // Raptor Saddle
		      EngramIds.Add("d5cd431a-1a7b-5c30-95fb-dbbe0af4e671") // Pteranodon Saddle
		      EngramIds.Add("c6ce03d5-97ed-5d90-a352-638788e7bfcd") // Rex Saddle
		      EngramIds.Add("a97e3600-e611-5caa-b397-ad20c8089c18") // Tek Rex Saddle
		      EngramIds.Add("d45d0691-a430-4443-98e3-bcc501067317") // Rock Drake Saddle
		      EngramIds.Add("c52794f4-4329-4d15-8952-68631fd61060") // Tek Rock Drake Saddle
		      EngramIds.Add("2b2d619b-fe82-59d6-9399-fec44c33f7a2") // Doedicurus Saddle
		      EngramIds.Add("52ece996-649e-4fb7-abca-7cfbe72dae24") // Rock Golem Saddle
		      EngramIds.Add("da2880ea-55bb-5e79-8ec9-1d9f76b310ff") // Tropeognathus Saddle
		      EngramIds.Add("64665fe6-9ec2-55df-9810-3f5824268db2") // Metal Shield
		      EngramIds.Add("b500d917-4dc2-5e69-b806-8b5180c3f18f") // Riot Shield
		      EngramIds.Add("333501ed-86af-55c4-bbc6-3845fc31a31e") // Tek Shield
		    End If
		    
		    For Each EngramId As String In EngramIds
		      Var Engram As ArkSA.Engram = DataSource.GetEngram(EngramId)
		      If Engram Is Nil Then
		        Continue
		      End If
		      Engrams.Add(Engram)
		    Next
		  End If
		  
		  Var SelectedEngramIds() As String
		  Var List As BeaconListbox = Self.PreviewList
		  If List.SelectedRowCount = 1 Then
		    SelectedEngramIds.Add(ArkSA.Engram(List.RowTagAt(List.SelectedRowIndex)).EngramId)
		  ElseIf List.SelectedRowCount > 1 Then
		    For RowIdx As Integer = 0 To List.LastRowIndex
		      If List.RowSelectedAt(RowIdx) = False Then
		        Continue
		      End If
		      SelectedEngramIds.Add(ArkSA.Engram(List.RowTagAt(RowIdx)).EngramId)
		    Next
		  End If
		  
		  Var ScrollPosition As Integer = List.ScrollPosition
		  
		  Var Config As ArkSA.Configs.StatLimits = Self.Config(False)
		  List.SelectionChangeBlocked = True
		  List.RemoveAllRows()
		  For Each Engram As ArkSA.Engram In Engrams
		    Var Stats() As ArkSA.EngramStat = Engram.AllStats(True)
		    If Stats.Count = 0 Then
		      Continue
		    End If
		    
		    List.AddRow(Engram.Label)
		    Var RowIdx As Integer = List.LastAddedRowIndex
		    List.RowTagAt(RowIdx) = Engram
		    List.RowSelectedAt(RowIdx) = SelectedEngramIds.IndexOf(Engram.EngramId) > -1
		    
		    For Each Stat As ArkSA.EngramStat In Stats
		      Var Value As NullableDouble = Config.Value(Stat.StatIndex)
		      If Value Is Nil Then
		        Continue
		      End If
		      
		      Var ColumnIdx As Integer = Self.StatToColumn(Stat.StatIndex)
		      Var Limit As Double = Stat.ComputeEffectiveLimit(Value.DoubleValue)
		      Var CellValue As String = Limit.PrettyText(2, True)
		      If Self.ColumnIsPercentage(ColumnIdx) Then
		        CellValue = CellValue + "%"
		      End If
		      
		      List.CellTextAt(RowIdx, ColumnIdx) = CellValue
		    Next
		  Next
		  List.SelectionChangeBlocked = False
		  List.ScrollPosition = ScrollPosition
		End Sub
	#tag EndMethod


	#tag Constant, Name = ColumnAmmo, Type = Double, Dynamic = False, Default = \"4", Scope = Private
	#tag EndConstant

	#tag Constant, Name = ColumnArmor, Type = Double, Dynamic = False, Default = \"1", Scope = Private
	#tag EndConstant

	#tag Constant, Name = ColumnDamage, Type = Double, Dynamic = False, Default = \"3", Scope = Private
	#tag EndConstant

	#tag Constant, Name = ColumnDurability, Type = Double, Dynamic = False, Default = \"2", Scope = Private
	#tag EndConstant

	#tag Constant, Name = ColumnGeneric, Type = Double, Dynamic = False, Default = \"7", Scope = Private
	#tag EndConstant

	#tag Constant, Name = ColumnHyper, Type = Double, Dynamic = False, Default = \"6", Scope = Private
	#tag EndConstant

	#tag Constant, Name = ColumnHypo, Type = Double, Dynamic = False, Default = \"5", Scope = Private
	#tag EndConstant

	#tag Constant, Name = ColumnLabel, Type = Double, Dynamic = False, Default = \"0", Scope = Private
	#tag EndConstant

	#tag Constant, Name = ColumnWeight, Type = Double, Dynamic = False, Default = \"8", Scope = Private
	#tag EndConstant


#tag EndWindowCode

#tag Events StatCheckboxes
	#tag Event
		Sub ValueChanged(index as Integer)
		  Self.StatFields(Index).Enabled = Me.Value
		  
		  Var Column As Integer = Self.StatToColumn(Index)
		  Self.PreviewList.ColumnTypeAt(Column) = If(Me.Value, DesktopListbox.CellTypes.TextField, DesktopListbox.CellTypes.Normal)
		  
		  If Self.SettingUp Then
		    Return
		  End If
		  
		  Self.SettingUp = True
		  If Not Me.Value Then
		    Self.Config(True).Value(Index) = Nil
		    Self.StatFields(Index).Text = ""
		  Else
		    Var Value As NullableDouble = Self.Config(False).Value(Index)
		    If Value = Nil Then
		      Self.StatFields(Index).Text = "0"
		      Self.Config(True).Value(Index) = 0
		    Else
		      Var DoubleValue As Double = Value
		      Self.StatFields(Index).Text = DoubleValue.PrettyText
		    End If
		  End If
		  Self.SettingUp = False
		  Self.Modified = True
		  Self.UpdateList()
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events StatFields
	#tag Event
		Sub TextChanged(index as Integer)
		  If Self.SettingUp Then
		    Return
		  End If
		  
		  Var StringValue As String = Me.Text
		  If Not IsNumeric(StringValue) Then
		    Return
		  End If
		  
		  Self.Config(True).Value(Index) = Double.FromString(StringValue, Locale.Current)
		  Self.Modified = True
		  Self.UpdateList
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events PreviewList
	#tag Event
		Sub Opening()
		  For Column As Integer = Self.ColumnArmor To Self.ColumnWeight
		    Me.ColumnAlignmentAt(Column) = DesktopListbox.Alignments.Right
		  Next
		End Sub
	#tag EndEvent
	#tag Event
		Sub CellAction(row As Integer, column As Integer)
		  Var CellValue As String = Me.CellTextAt(Row, Column).Trim
		  If CellValue.EndsWith("%") Then
		    CellValue = CellValue.Left(CellValue.Length - 1)
		  End If
		  If Not IsNumeric(CellValue) Then
		    Self.UpdateList()
		    Return
		  End If
		  
		  Var Engram As ArkSA.Engram = Me.RowTagAt(Row)
		  Var Stat As ArkSA.EngramStat = Engram.Stat(Self.ColumnToStat(Column))
		  If Stat Is Nil Then
		    Self.UpdateList()
		    Return
		  End If
		  
		  Self.SettingUp = True
		  
		  Var Limit As Double = Double.FromString(CellValue, Locale.Current)
		  Var Value As Double = Stat.SolveForDesiredLimit(Limit)
		  Self.Config(True).Value(Stat.StatIndex) = Value
		  Self.StatFields(Stat.StatIndex).Text = Value.PrettyText(0, True)
		  
		  Self.SettingUp = False
		  Self.Modified = True
		  Self.UpdateList()
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events ConfigToolbar
	#tag Event
		Sub Opening()
		  Me.Append(OmniBarItem.CreateTitle("ConfigTitle", Self.ConfigLabel))
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events FilterField
	#tag Event
		Sub TextChanged()
		  Self.UpdateList()
		End Sub
	#tag EndEvent
#tag EndEvents
#tag ViewBehavior
	#tag ViewProperty
		Name="Modified"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Composited"
		Visible=true
		Group="Window Behavior"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Index"
		Visible=true
		Group="ID"
		InitialValue="-2147483648"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="IsFrontmost"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="ViewTitle"
		Visible=true
		Group="Behavior"
		InitialValue="Untitled"
		Type="String"
		EditorType="MultiLineEditor"
	#tag EndViewProperty
	#tag ViewProperty
		Name="ViewIcon"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Picture"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Progress"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MinimumWidth"
		Visible=true
		Group="Behavior"
		InitialValue="400"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MinimumHeight"
		Visible=true
		Group="Behavior"
		InitialValue="300"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Name"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Super"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Width"
		Visible=true
		Group="Size"
		InitialValue="300"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Height"
		Visible=true
		Group="Size"
		InitialValue="300"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="InitialParent"
		Visible=false
		Group="Position"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Left"
		Visible=true
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Top"
		Visible=true
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockLeft"
		Visible=true
		Group="Position"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockTop"
		Visible=true
		Group="Position"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockRight"
		Visible=true
		Group="Position"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockBottom"
		Visible=true
		Group="Position"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabIndex"
		Visible=true
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabPanelIndex"
		Visible=false
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabStop"
		Visible=true
		Group="Position"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowAutoDeactivate"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Enabled"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Tooltip"
		Visible=true
		Group="Appearance"
		InitialValue=""
		Type="String"
		EditorType="MultiLineEditor"
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowFocusRing"
		Visible=true
		Group="Appearance"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Visible"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="BackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="&hFFFFFF"
		Type="ColorGroup"
		EditorType="ColorGroup"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Backdrop"
		Visible=true
		Group="Background"
		InitialValue=""
		Type="Picture"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasBackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowFocus"
		Visible=true
		Group="Behavior"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowTabs"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Transparent"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
#tag EndViewBehavior
